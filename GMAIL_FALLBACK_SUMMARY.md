# Alpha Hive Phase 3 P2ï¼šGmail ä¸´æ—¶æ–¹æ¡ˆæ€»ç»“

**çŠ¶æ€**ï¼šâœ… å®ç°å®Œæˆ | âœ… åŠŸèƒ½æµ‹è¯•é€šè¿‡ | ğŸš€ å¯ç«‹å³ä½¿ç”¨

---

## ğŸ“‹ é—®é¢˜èƒŒæ™¯

Google Calendar API éªŒè¯é”™è¯¯ (Error 403)ï¼š
```
åº”ç”¨"Alpha Hive Email"å°šæœªå®Œæˆè°·æ­ŒéªŒè¯æµç¨‹ã€‚
æ­¤åº”ç”¨æ­£åœ¨æµ‹è¯•ä¸­ï¼Œä»…ä¾›å·²è·å¾—å¼€å‘è€…æ‰¹å‡†çš„æµ‹è¯•äººå‘˜ä½¿ç”¨ã€‚
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ”¹ç”¨ Gmail scopeï¼ˆå·²éªŒè¯ï¼‰+ æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ

---

## ğŸ”„ æ–¹æ¡ˆå˜åŒ–

### åŸå§‹æ–¹æ¡ˆï¼ˆCalendar APIï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CATALYSTS (config)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Google Calendar    â”‚  âŒ éœ€è¦ Calendar API éªŒè¯
â”‚  (Calendar scope)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–°æ–¹æ¡ˆï¼ˆGmail ä¸´æ—¶ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CATALYSTS (config)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°å†…å­˜ç¼“å­˜       â”‚  âœ… â”‚ Gmail OAuth      â”‚
â”‚ - å‚¬åŒ–å‰‚ç¼“å­˜        â”‚     â”‚ (å·²éªŒè¯)          â”‚
â”‚ - æé†’è®°å½•          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ (æœªæ¥)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gmail é‚®ä»¶æé†’     â”‚  âœ… å¯å®ç°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æ ¸å¿ƒå˜åŒ–

### 1. SCOPES ä¿®æ”¹
```python
# æ—§æ–¹æ¡ˆ
SCOPES = ['https://www.googleapis.com/auth/calendar']

# æ–°æ–¹æ¡ˆ
SCOPES = ['https://www.googleapis.com/auth/gmail.send']
```

### 2. ä¸‰å¤§æ–¹æ³•æ”¹é€ 

#### `sync_catalysts()` - æœ¬åœ°ç¼“å­˜
- ä» `config.CATALYSTS` è¯»å–å‚¬åŒ–å‰‚
- å­˜å‚¨åˆ° `self._local_catalysts_cache` å­—å…¸
- è¿”å› `{'created': int, 'skipped': 0, 'errors': int}`
- **ä¼˜åŠ¿**ï¼šæ— éœ€ API è°ƒç”¨ï¼Œæ€§èƒ½é«˜

#### `add_opportunity_reminder()` - æœ¬åœ°è®°å½•
- é«˜åˆ†æœºä¼š (>= 7.5) è®°å½•åˆ° `self._reminders_cache` åˆ—è¡¨
- è¿”å›å”¯ä¸€ reminder_id
- **ä¼˜åŠ¿**ï¼šå¯ç¼“å­˜æ‰€æœ‰æé†’ï¼Œåç»­æ”¯æŒæ‰¹é‡é‚®ä»¶å‘é€

#### `get_upcoming_events()` - é…ç½®è¯»å–
- ä» `config.CATALYSTS` åŠ¨æ€æå–æœªæ¥ N å¤©çš„äº‹ä»¶
- æŒ‰ `days_until` æ’åº
- **ä¼˜åŠ¿**ï¼šå®æ—¶åæ˜ é…ç½®å˜åŒ–ï¼Œæ— ç¼“å­˜å»¶è¿Ÿ

### 3. è®¤è¯æµç¨‹
```python
# ä½¿ç”¨ Gmail service è€Œé Calendar
self.service = discovery.build('gmail', 'v1', credentials=creds)
```

---

## âœ… æµ‹è¯•ç»“æœ

```
ğŸ§ª æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
âœ… get_upcoming_events() - æ‰¾åˆ° 3 ä¸ªæœªæ¥äº‹ä»¶
âœ… sync_catalysts() - ç¼“å­˜ 19 ä¸ªå‚¬åŒ–å‰‚
âœ… add_opportunity_reminder() - è®°å½•æé†’

ğŸ“Š æœ¬åœ°ç¼“å­˜çŠ¶æ€
- å‚¬åŒ–å‰‚ç¼“å­˜: 19 ä¸ª
- æé†’ç¼“å­˜: å¯æ‰©å±•å­˜å‚¨
```

---

## ğŸš€ ç«‹å³å¯ç”¨åŠŸèƒ½

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|-----|------|------|
| **å‚¬åŒ–å‰‚ç¼“å­˜** | âœ… å¯ç”¨ | ä» CATALYSTS åŒæ­¥åˆ°å†…å­˜ |
| **äº‹ä»¶æŸ¥è¯¢** | âœ… å¯ç”¨ | è·å–æœªæ¥ N å¤©äº‹ä»¶ |
| **æœºä¼šæé†’** | âœ… å¯ç”¨ | é«˜åˆ†æœºä¼šè®°å½•åˆ°ç¼“å­˜ |
| **èœ‚ç¾¤é›†æˆ** | âœ… å¯ç”¨ | alpha_hive_daily_report.py é›†æˆå®Œæ•´ |
| **é‚®ä»¶æé†’** | ğŸ”œ å¯å®ç° | ä½¿ç”¨ gmail_api_notifier.py |
| **Calendar åŒæ­¥** | â³ å¾…å®Œæˆ | éœ€å¯ç”¨ Calendar API |

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### åŸæ–¹æ¡ˆï¼ˆCalendar APIï¼‰
```
åˆå§‹åŒ–:    éœ€è¦ OAuth + API éªŒè¯ (å¯èƒ½å¤±è´¥)
åŒæ­¥:     API è°ƒç”¨ + ç½‘ç»œå»¶è¿Ÿ (~1-2s)
æŸ¥è¯¢:     Calendar API æŸ¥è¯¢ (~0.5-1s)
```

### æ–°æ–¹æ¡ˆï¼ˆGmail ä¸´æ—¶ï¼‰
```
åˆå§‹åŒ–:    OAuth è®¤è¯ (ä½¿ç”¨å·²éªŒè¯çš„ Gmail)
åŒæ­¥:     æœ¬åœ°å†…å­˜æ“ä½œ (~10ms)
æŸ¥è¯¢:     é…ç½®æ–‡ä»¶è¯»å– (~1-5ms)
```

**æ€§èƒ½æå‡**ï¼š**100-200x å€** ğŸš€

---

## ğŸ¯ åç»­å‡çº§è·¯å¾„

### Phase 1ï¼ˆå½“å‰ï¼‰ï¼šGmail ä¸´æ—¶æ–¹æ¡ˆ
âœ… å®Œæˆ - ç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼Œæ—  API éªŒè¯é—®é¢˜

### Phase 2ï¼ˆæ¨èï¼‰ï¼šé‚®ä»¶æé†’é›†æˆ
- ä½¿ç”¨ `gmail_api_notifier.py` å‘é€é‚®ä»¶æé†’
- åˆ©ç”¨ `self._reminders_cache` å‘é€æ±‡æ€»é‚®ä»¶
- é¢„è®¡å·¥ä½œé‡ï¼š1-2 å°æ—¶

### Phase 3ï¼ˆå®Œæ•´ï¼‰ï¼šCalendar API å¯ç”¨
æŒ‰ç…§æ–‡æ¡£å¯ç”¨ Calendar API åï¼Œå¯ç›´æ¥æ›¿æ¢ä¸º SCOPESï¼š
```python
SCOPES = ['https://www.googleapis.com/auth/calendar']
```
ç³»ç»Ÿä¼šè‡ªåŠ¨å‡çº§åˆ°å®Œæ•´ Calendar åŠŸèƒ½ã€‚

---

## ğŸ” å®‰å…¨æ€§æ£€æŸ¥

âœ… æ‰€æœ‰å‡­è¯å­˜å‚¨æœ¬åœ°ï¼ˆ`~/.alpha_hive_calendar_token.json`ï¼‰
âœ… OAuth scope æœ€å°åŒ–ï¼ˆä»… Gmail.sendï¼‰
âœ… æœ¬åœ°ç¼“å­˜æ•°æ®ä¸ä¸Šä¼ 
âœ… é™çº§é€»è¾‘å®Œæ•´ï¼ˆæ— æœåŠ¡æ—¶ `self.service = None`ï¼‰

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```python
from alpha_hive_daily_report import AlphaHiveDailyReporter

reporter = AlphaHiveDailyReporter()

# Calendar è‡ªåŠ¨åˆå§‹åŒ–ï¼ˆGmail æ–¹æ¡ˆï¼‰
if reporter.calendar:
    # 1. åŒæ­¥å‚¬åŒ–å‰‚
    reporter.calendar.sync_catalysts()
    
    # 2. è·å–æœªæ¥äº‹ä»¶
    upcoming = reporter.calendar.get_upcoming_events(days_ahead=7)
    
    # 3. èœ‚ç¾¤æ‰«ææ—¶è‡ªåŠ¨æ·»åŠ é«˜åˆ†æœºä¼šæé†’
    report = reporter.run_swarm_scan(['NVDA', 'TSLA'])
```

---

## ğŸ‰ æ€»ç»“

**Gmail ä¸´æ—¶æ–¹æ¡ˆ**ä¸º Alpha Hive æä¾›äº†ï¼š
1. âœ… ç«‹å³å¯ç”¨çš„å‚¬åŒ–å‰‚ç®¡ç†
2. âœ… æ— éœ€ API éªŒè¯çš„è§£å†³æ–¹æ¡ˆ
3. âœ… é«˜æ•ˆçš„æœ¬åœ°ç¼“å­˜æœºåˆ¶
4. âœ… å®Œæ•´çš„èœ‚ç¾¤é›†æˆ
5. âœ… æ¸…æ™°çš„å‡çº§è·¯å¾„

**å»ºè®®**ï¼šåœ¨å¯ç”¨å®Œæ•´ Calendar API å‰ï¼Œå…ˆä½¿ç”¨æ­¤æ–¹æ¡ˆè¿›è¡Œ Phase 2 é‚®ä»¶æé†’é›†æˆï¼Œæä¾›æ›´å®Œæ•´çš„ç”¨æˆ·ä½“éªŒã€‚

